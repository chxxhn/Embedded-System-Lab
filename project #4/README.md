# Project #4 - Interrupt 방식의 GPIO 제어 및 UART 통신 

이 프로젝트는 STM32F107 마이크로컨트롤러에서 Interrupt 방식을 이용한 GPIO 제어와 UART 통신을 실습하는 내용을 담고 있습니다. 버튼과 UART 통신을 통해 인터럽트를 발생시키고, 해당 인터럽트의 우선순위를 설정하여 다양한 동작을 제어합니다.

---

## 목차
- [목적](#목적)
- [실험 장비](#실험-장비)
- [프로젝트 설정](#프로젝트-설정)
  - [1. 개발 환경 구성](#1-개발-환경-구성)
  - [2. GPIO 및 EXTI 설정](#2-gpio-및-exti-설정)
  - [3. UART 설정](#3-uart-설정)
  - [4. NVIC 설정](#4-nvic-설정)
  - [5. 인터럽트 핸들러 설정](#5-인터럽트-핸들러-설정)
- [실험 과정](#실험-과정)
- [실험 결과](#실험-결과)

---

## 목적
- Interrupt 방식을 활용하여 GPIO 제어 및 UART 통신 구현
- 라이브러리 함수와 구조체를 활용한 레지스터 설정 및 인터럽트 제어 숙지

## 실험 장비
- **마이크로컨트롤러**: STM32F107VCT6
- **개발 환경**: IAR Embedded Workbench (EW)
- **추가 장비**: PC (Putty 등 UART 통신 프로그램)

## 프로젝트 설정
### 1. 개발 환경 구성
project #1와 동일한 방식으로 프로젝트를 생성하고 파일 구조를 설정합니다.

### 2. GPIO 및 EXTI 설정
- `GPIO_InitTypeDef` 구조체를 사용하여 LED와 버튼 GPIO 핀을 설정합니다.
- EXTI(External Interrupt)를 사용하여 GPIO 핀에 인터럽트를 설정합니다.
  - **S1 버튼**: GPIO C 포트의 4번 핀에 연결
  - **S2 버튼**: GPIO B 포트의 10번 핀에 연결
  - **S3 버튼**: GPIO C 포트의 13번 핀에 연결
  - GPIO 핀들은 EXTI 라인과 연결되며, Falling Edge 트리거로 설정됩니다.

### 3. UART 설정
- `USART_InitTypeDef` 구조체를 이용하여 UART1 통신을 설정합니다.
- Baud Rate, 워드 길이, 패리티 비트, 정지 비트 등 UART 설정을 구성합니다.
- UART 통신을 활성화하여 PC와 연결하고, Putty 프로그램을 통해 제어할 수 있도록 설정합니다.

### 4. NVIC 설정
- `NVIC_InitTypeDef` 구조체를 사용하여 NVIC(Nested Vectored Interrupt Controller)의 우선순위를 설정합니다.
- 버튼 및 UART 인터럽트의 우선순위를 설정하여 인터럽트 발생 시 우선순위에 따라 처리되도록 합니다.

### 5. 인터럽트 핸들러 설정
- `EXTI4_IRQHandler`, `EXTI15_10_IRQHandler`, `USART1_IRQHandler`를 정의하여 인터럽트 발생 시 실행되는 코드를 작성합니다.
  - **EXTI4_IRQHandler**: S1 버튼을 누르면 A 동작 수행
  - **EXTI15_10_IRQHandler**: S2 버튼을 누르면 B 동작 수행, S3 버튼을 누르면 "TEAM02" 메시지 출력
  - **USART1_IRQHandler**: PC에서 'a' 입력 시 A 동작, 'b' 입력 시 B 동작 수행

## 실험 과정
1. **프로젝트 생성 및 파일 구조 설정**: 4주차와 동일한 방식으로 프로젝트를 생성하고 파일 구조를 설정합니다.
2. **Clock 설정**: PLL과 HCLK, PCLK2를 설정하여 원하는 System Clock을 구성합니다.
3. **GPIO 및 EXTI 설정**: LED와 버튼 GPIO를 설정하고, EXTI를 통해 Interrupt를 발생시킵니다.
4. **UART 설정**: Baud rate를 지정하여 UART 통신을 설정합니다.
5. **NVIC 설정**: 각 인터럽트의 우선순위를 설정하여, 다른 인터럽트가 발생해도 우선순위에 따라 처리될 수 있도록 합니다.
6. **인터럽트 핸들러 작성**: 각 버튼 및 UART 입력에 따라 동작하는 인터럽트 핸들러를 구현합니다.
7. **오실로스코프 확인**: MCO 핀을 오실로스코프에 연결하여 설정된 System Clock 주파수를 확인합니다.
8. **시리얼 통신 확인**: Putty 등 시리얼 통신 프로그램을 통해 UART 통신이 정상적으로 이루어지는지 확인합니다.

## 실험 결과
- **S1 버튼**: S1 버튼을 누르면 LED가 1->2->3->4 순서로 켜집니다.
- **S2 버튼**: S2 버튼을 누르면 LED가 4->3->2->1 순서로 켜집니다.
- **S3 버튼**: S3 버튼을 누르면 "TEAM02" 메시지가 Putty에 출력됩니다.
- **a 입력**: Putty에서 'a'를 입력하면 LED가 1->2->3->4 순서로 켜집니다.
- **b 입력**: Putty에서 'b'를 입력하면 LED가 4->3->2->1 순서로 켜집니다.

